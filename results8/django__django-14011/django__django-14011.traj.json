{
  "info": {
    "submission": "diff --git a/django/test/testcases.py b/django/test/testcases.py\nindex 92f566b7b0..137c51a1fa 100644\n--- a/django/test/testcases.py\n+++ b/django/test/testcases.py\n@@ -1468,10 +1468,19 @@ class _MediaFilesHandler(FSFilesHandler):\n     \"\"\"\n     def get_base_dir(self):\n         return settings.MEDIA_ROOT\n+class ClosingThreadedWSGIServer(ThreadedWSGIServer):\n+    # Make worker threads daemon so they don't need to be joined at shutdown\n+    daemon_threads = True\n \n-    def get_base_url(self):\n-        return settings.MEDIA_URL\n+    def server_close(self):\n+        # First perform normal server close\n+        super().server_close()\n+        # Then ensure all Django DB connections are closed (closes per-thread connections)\n+        connections.close_all()\n \n+class LiveServerThread(threading.Thread):\n+    \"\"\"Thread for running a live http server while the tests are running.\"\"\"\n+    server_class = ClosingThreadedWSGIServer\n \n class LiveServerThread(threading.Thread):\n     \"\"\"Thread for running a live http server while the tests are running.\"\"\"",
    "config": {
      "agent": "swe-agent",
      "model": "gpt-5-mini"
    }
  },
  "messages": [],
  "trajectory_format": "mini-swe-agent-1",
  "instance_id": "django__django-14011"
}